<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>In-Depth Quantum Mechanics</title>
  <meta name="description" content=" This is a guide to quantum mechanics beyond the basics, and is a follow-up to introductory quantum physics. Topics convered include state-vectors, Hilbert spaces, intrinsic spin and the Pauli matrices, the hydrogen atom in detail, the quantum harmonic oscillator, time-independent perturbation theory, and a basic overview of second quantization and relativistic quantum mechanics.
">

  
      <link rel="icon" type="image/svg+xml" href="https://jackysci.com/favicon.svg">
      <link rel="icon" type="image/png" href="https://jackysci.com/favicon.ico">
  

  
      <link rel="stylesheet" href="https://jackysci.com/site.css">
      <!--KaTeX-->
      <link rel="stylesheet" href="https://jackysci.com/katex/katex.min.css">

      <!--Inter-->
      <link rel="stylesheet" href="https://jackysci.com/inter/inter.css">
  

</head>

<body>

  <nav>
    <a href="/" class="active">Home</a>
    <!--incomplete about page
    <a href="about.html">About</a>
    -->
    <a href="https://jackysci.com/notes/">Notes</a>
    <a href="https://lightofhope.site/">Music</a>
    <a href="https://github.com/Songtech-0912">GitHub</a>
  </nav>

  
    <article class="post">
        <h1>In-Depth Quantum Mechanics</h2>
        
        <p id="print-notice">This page is print-friendly. Simply press Ctrl + P (or Command + P if you use a Mac) to print the page and download it as a PDF. <a href="https://forms.gle/msb5wKErDJCjeL5k6">Report an issue or error here</a>.</p>

        
        
        <!-- table of contents -->
        
        <details class="toc" id="toc" open>
        <summary>Table of contents</summary>
        <p class="toc-info">Note: it is highly recommended to navigate by clicking links in the table of contents! It means you can use the back button in your browser to go back to any section you were reading, so you can jump back and forth between sections!</p>
        <div>
            <ul>
            
                <li>
                    <a href="#prerequisites">Prerequisites</a>
                    
                </li>
            
                <li>
                    <a href="#foreword">Foreword</a>
                    
                </li>
            
                <li>
                    <a href="#basics-of-wave-mechanics">Basics of wave mechanics</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="#introduction-to-wave-mechanics">Introduction to wave mechanics</a>
                                </li>
                            
                                <li>
                                    <a href="#the-free-particle">The free particle</a>
                                </li>
                            
                                <li>
                                    <a href="#quantum-operators">Quantum operators</a>
                                </li>
                            
                                <li>
                                    <a href="#the-born-rule">The Born rule</a>
                                </li>
                            
                                <li>
                                    <a href="#bound-and-scattering-states">Bound and scattering states</a>
                                </li>
                            
                        </ul>
                    
                </li>
            
                <li>
                    <a href="#the-abstract-state-vector-formalism">The abstract state-vector formalism</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="#review-of-linear-algebra">Review of linear algebra</a>
                                </li>
                            
                                <li>
                                    <a href="#introduction-to-dirac-s-bra-ket-notation">Introduction to Dirac&#x27;s bra-ket notation</a>
                                </li>
                            
                                <li>
                                    <a href="#the-state-vector-and-unitary-time-evolution">The state-vector and unitary time evolution</a>
                                </li>
                            
                        </ul>
                    
                </li>
            
                <li>
                    <a href="#intrinsic-spin">Intrinsic spin</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="#what-exactly-is-intrinsic-spin">What exactly is intrinsic spin?</a>
                                </li>
                            
                                <li>
                                    <a href="#the-stern-gerlach-experiment">The Stern-Gerlach experiment</a>
                                </li>
                            
                                <li>
                                    <a href="#application-to-electronics">Application to electronics</a>
                                </li>
                            
                        </ul>
                    
                </li>
            
                <li>
                    <a href="#advanced-quantum-theory">Advanced quantum theory</a>
                    
                        <ul>
                            
                                <li>
                                    <a href="#relativistic-wave-equations-and-the-dirac-equation">Relativistic wave equations and the Dirac equation</a>
                                </li>
                            
                                <li>
                                    <a href="#second-quantization-and-quantum-electrodynamics">Second quantization and quantum electrodynamics</a>
                                </li>
                            
                                <li>
                                    <a href="#relativity-the-dirac-equation-and-the-road-to-qft">Relativity, the Dirac equation, and the road to QFT</a>
                                </li>
                            
                                <li>
                                    <a href="#the-emergence-of-field-quanta">The emergence of field quanta</a>
                                </li>
                            
                                <li>
                                    <a href="#second-quantization">Second quantization</a>
                                </li>
                            
                                <li>
                                    <a href="#the-spin-statistics-theorem">The spin-statistics theorem</a>
                                </li>
                            
                        </ul>
                    
                </li>
            
            </ul>
        </div>
        </details>
        

        <!-- page content -->
        <p>This is a guide to quantum mechanics beyond the basics, and is a follow-up to <a href="https://jackysci.com/intro-quantum-phys/">introductory quantum physics</a>. Topics convered include state-vectors, Hilbert spaces, intrinsic spin and the Pauli matrices, the hydrogen atom in detail, the quantum harmonic oscillator, time-independent perturbation theory, and a basic overview of second quantization and relativistic quantum mechanics.</p>
<span id="continue-reading"></span>
<p>I thank <a href="https://www.xmeng.io">Professor Meng</a> at Rensselaer Polytechnic Institute, without whom this guide would not have been possible.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>This guide will assume considerable prior knowledge, including multivariable &amp; vector calculus, linear algebra, basic quantum mechanics, integration with delta functions, classical waves, Fourier series, solving boundary-value problems, and (in later chapters) tensors and special relativity. If you don't know some (or all) of these, that's okay! There are dedicated guides about each of these topics on this site:</p>
<ul>
<li>For a review of calculus (in particular multivariable and vector calculus), see the <a href="https://jackysci.com/calculus-series/">calculus series</a></li>
<li>For a review of the classical theory of waves, see the <a href="https://jackysci.com/waves-and-oscillations/">waves and oscillations guide</a></li>
<li>For a review of basic quantum mechanics, see the <a href="https://jackysci.com/intro-quantum-phys/">introductory quantum mechanics guide</a></li>
<li>For a review of electromagnetic theory, see the <a href="https://jackysci.com/electromagnetism/">fundamentals of electromagnetism guide</a> as well as the <a href="https://jackysci.com/classical-electromagnetism/">in-depth electromagnetism guide</a></li>
<li>For a review of boundary-value problems, Fourier series, and see the <a href="https://jackysci.com/intro-pdes/">PDEs guide</a></li>
<li>For a review of special relativity and tensors, see the <a href="https://jackysci.com/advanced-classical-mech/">advanced classical mechanics guide</a></li>
</ul>
<h2 id="foreword">Foreword</h2>
<p>Quantum mechanics is a fascinating subject. Developed primarily in the early 20th-century, it is a theory that (at the time of writing) is barely a hundred years old, but its impact on physics and technology is immense. Without quantum mechanics, we would not have solid-state hard drives, phones, LED lights, or MRI scanners. Quantum mechanics has revolutionized the world we live in, and this is despite the fact that it governs the behavior of particles smaller than we could ever possibly see. But understanding how matter behaves at tiny, microscopic scales is the key to understanding how matter on macroscopic scales behaves. Quantum mechanics unlocks the secrets of the microscopic world, and however unintuitive it may be, it is the best (nonrelativistic) theory we have to understand this strange, mysterious world.</p>
<h2 id="basics-of-wave-mechanics">Basics of wave mechanics</h2>
<p>In classical physics, it was well-known that there was a clear distinction between two phenomena: <em>particles</em> and <em>waves</em>. Waves are oscillations in some medium and are not localized in space; particles, by contrast, are able to move freely and are localized. We observe, however, in the quantum world, that "waves" and "particles" are both <em>incomplete descriptions</em> of matter at its most fundamental level. Quantum mechanics (at least without the inclusion of quantum field theory) does <strong>not</strong> answer <em>why</em> this is the case, but it offers a powerful theoretical framework to <em>describe</em> the wave nature of matter, called <strong>wave mechanics</strong>. In turn, understanding the wave nature of matter allows us to make powerful predictions about how matter behaves at a fundamental level, and is the foundation of modern physics.</p>
<h3 id="introduction-to-wave-mechanics">Introduction to wave mechanics</h3>
<p>From the classical theory of waves and classical dynamics, we can build up some basic (though not entirely correct) intuition for quantum theory. Consider a hydrogen atom, composed of a positively-charged nucleus, and a negatively-charged electron. Let us assume that the nucleus is so heavy compared to the electron that it may be considered essentially a classical point charge. Let us also assume that the electron orbits the nucleus at some known distance $R$. For the electron to not decay and fall into the nucleus, classical mechanics tells us that its potential energy and kinetic energy must balance each other. Thus, the electron must both be moving and have some amount of potential energy, which comes from the electrostatic attraction of the electron to the nucleus. This bears great resemblance to another system: the orbital motion of the planets around the solar system.</p>
<p>However, experiments conducted in the early 20th century revealed that atoms emit light of specific wavelengths, meaning that they could only carry discrete energies, and therefore only be found at certain locations from the nucleus. This would not be strange in and of itself, but these experiments <em>also</em> found that electrons could "jump" seemingly randomly between different orbits around the nucleus. That is to say, an electron might initially be at radius $R_1$, but then it suddenly jumps to $R_3$, then jumps to $R_2$, but cannot be found anywhere between $R_1$ and $R_2$ or between $R_2$ and $R_3$. This meant that electrons could <em>not</em> be modelled in the same way as planets orbiting the Sun - this jumpy "orbit" would be a very strange one indeed!</p>
<p>Instead, physicists wondered if it would make more sense to model electrons as <em>waves</em>. This may seem absolutely preposterous on first inspection, but it makes more sense when you think about it more deeply. First, a wave isn't localized in space; instead, it <em>fills all space</em>, so if the electron was indeed a wave, it would be possible to find the electron at different points in space ($R_1, R_2, R_3$) throughout time. In addition, waves also <em>oscillate</em> through space and time at very particular frequencies. It is common to package the <em>spatial frequency</em> of a wave via a <strong>wavevector</strong> $\mathbf{k} = \langle k_x, k_y, k_z\rangle$ and the <em>temporal frequency</em> of a wave via an <strong>angular frequency</strong> $\omega$ (for reasons we'll soon see). Since these spatial and temporal frequencies can only take particular values, the shape of the wave is also restricted to particular functions, meaning the pulses of the wave could only be found at particular locations. If we guess the pulses of the wave to be somehow linked to the position of the electron (and this is a correct guess!), that would neatly give an explanation for why electrons could only be found at particular orbits around the nucleus and <em>never</em> between two orbits.</p>
<p>The simplest types of waves are <strong>plane waves</strong>, which may be described by complex-valued exponentials $e^{i(\mathbf{k} \cdot \mathbf{x} + \omega t)}$, or by equivalent real-valued sinusoids $\cos(\mathbf{k}\cdot \mathbf{x} + \omega t)$. Thus, it would make sense to describe such waves with a complex-valued wave equation, where we use complex numbers for mathematical convenience (it is much easier to take derivatives of complex exponentials than real sinusoids). To start, let's assume that our electron is a wave whose spatial and time evolution are described by a certain function, which we'll call a <strong>wavefunction</strong> and denote $\Psi(x, t)$. We'll also assume for a free electron far away from any atom, the wavefunction has the mathematical form of a plane wave:</p>
<p class="mathcell">
$$
\Psi(x,t) = e^{i(\mathbf{k} \cdot \mathbf{x} - \omega t)}
$$
</p>
<p>Note that if we differentiate our plane-wave with respect to time, we find that:</p>
<p class="mathcell">
$$
\dfrac{\partial \Psi}{\partial t} = \dfrac{\partial}{\partial t}e^{i(\mathbf{k} \cdot \mathbf{x} - \omega t)} = \dfrac{\partial}{\partial t} e^{i\mathbf{k} \cdot \mathbf{x}} e^{-i\omega t} = -i\omega  e^{i(\mathbf{k} \cdot \mathbf{x} - \omega t)} = -i\omega \Psi(x, t)
$$
</p>
<p>We'll now introduce a historical discovery in physics that transforms this interesting but not very useful result into a powerful lead for quantum mechanics. In 1905, building on the work by German physicist Max Planck, Albert Einstein found that atoms emit and absorb energy in the form of light with a fixed amount of energy. This energy is given by the equation $E = h\nu$ (the <strong>Planck-Einstein relation</strong>), where $h = \pu{6.62607015E-34 J*s}$ is known as the <a href="https://en.wikipedia.org/wiki/Planck_constant">Planck constant</a>, and $\nu$ is the frequency of the light wave. Modern physicists usually like to write the Planck-Einstein relation in the equivalent form $E = \hbar \omega$, where $\omega = 2\pi \nu$. Armed with this information, we find that we can slightly rearrange our previous result to obtain an expression for the energy!</p>
<p class="mathcell">
$$
\omega \Psi(x, t) = \frac{1}{-i}\dfrac{\partial}{\partial t} \Psi(x, t) = i\dfrac{\partial}{\partial t} \Psi(x, t) \quad \Rightarrow \quad \hbar \omega = i\hbar\dfrac{\partial}{\partial t} \Psi(x, t) = E
$$
</p>
<blockquote>
<p><strong>Note:</strong> here, we used the fact that $\dfrac{1}{-i} = i$. You can prove this by multiplying $\dfrac{1}{-i}$ by $\dfrac{i}{i}$, which gives you $\dfrac{i}{1} = i$.</p>
</blockquote>
<p>Meanwhile, we know that the classical expression for the total energy is given by $E = K + V$, where $K$ is the kinetic energy and $V$ is the potential energy (in quantum mechanics, we often just call this the <em>potential</em> for short). The kinetic energy is related to the <em>momentum</em> $p$ of a classical particle by $K = \mathbf{p}^2/2m$ (where $\mathbf{p}^2 = \mathbf{p} \cdot \mathbf{p}$). This may initially seem relatively useless - we are talking about a quantum particle, not a classical one! - but let's assume that this equation still holds true in the quantum world.</p>
<p>Now, from experiments done in the early 20th-century, we found that all quantum particles have a fundamental quantity known as their <a href="https://en.wikipedia.org/wiki/Matter_wave">de Broglie wavelength</a> (after the French physicist Louis de Broglie who first theorized their existence), which we denote as $\lambda$. This wavelength is <em>tiny</em> - for electrons, $\lambda = \pu{167pm} = \pu{1.67E-10m}$, which is about ten million times smaller than a grain of sand. The momentum of a <em>quantum particle</em> is directly related to the de Broglie wavelength; in fact, it is given by $\mathbf{p} = \hbar \mathbf{k}$, where $|\mathbf{k}| = 2\pi/\lambda$. Combining $\mathbf{p} = \hbar \mathbf{k}$ and $K = \mathbf{p}^2/2m$, we have:</p>
<p class="mathcell">
$$
E = K + V = \dfrac{\mathbf{p}^2}{2m} + V(x) = \dfrac{(\hbar \mathbf{k})^2}{2m} + V(x)
$$
</p>
<p>Can we find another way to relate $\Psi$ and the energy $E$ using this formula? In fact, we can! If we take the <em>gradient</em> of our wavefunction, we have:</p>
<p class="mathcell">
$$
\nabla\Psi = \nabla e^{i\mathbf{k} \cdot \mathbf{x}} e^{-i\omega t} = e^{-i\omega t} \nabla e^{i\mathbf{k} \cdot \mathbf{x}}= e^{-i\omega t}i\mathbf{k} (e^{i\mathbf{k} \cdot \mathbf{x}}) = i\mathbf{k}  \Psi
$$
</p>
<p>Then, taking the divergence of the gradient (which is the <em>Laplacian operator</em> $\nabla^2 = \nabla \cdot \nabla$) we have:</p>
<p class="mathcell">
$$
\nabla^2 \Psi = (i\mathbf{k})^2 \Psi = -\mathbf{k}^2 \Psi \quad \Rightarrow \quad \mathbf{k}^2 = -\nabla^2 \Psi
$$
</p>
<p>Combining this with our classical-derived expression for the total energy, we have:</p>
<p class="mathcell">
$$
E = \dfrac{(\hbar \mathbf{k})^2}{2m} + V(x) = -\dfrac{\hbar^2}{2m}\nabla^2 \Psi + V \Psi
$$
</p>
<p>Where $V \Psi$ is some term that we presume (rightly so) to capture the <em>potential energy</em> of the quantum particle. Equating our two expressions for $E$, we have:</p>
<p class="mathcell">
$$
E = i\hbar\dfrac{\partial}{\partial t} \Psi(x, t) = -\dfrac{\hbar^2}{2m} \nabla^2 \Psi + V\Psi
$$
</p>
<p>Which gives us the <strong>Schrödinger equation</strong>:</p>
<p class="mathcell">
$$
i\hbar\dfrac{\partial}{\partial t} \Psi(x, t) = \left(-\dfrac{\hbar^2}{2m} \nabla^2 + V\right)\Psi(x,t)
$$
</p>
<p>What we have been calling $\Psi(x, t)$ can now be properly termed the <strong>wavefunction</strong>. But what is it? The predominant opinion is that the wavefunction should be considered a <strong>probability wave</strong>. That is to say, the wave is not a physically-observable quantity! We'll discuss the implications (and consequences) of this in time, but for now, we'll discuss 2 <em>real-valued</em> quantities that can be found</p>
<ol>
<li>The <strong>amplitude</strong> $|\Psi(x, t)|$ is the magnitude of the wavefunction</li>
<li>The <strong>phase</strong> $\phi = \text{arg}(\Psi) = \tan^{-1}\left(-\dfrac{\text{Im}(\Psi)}{\text{Re}(\Psi)}\right)$ describes how far along each oscillation the wavefunction has elapsed in space and time. (Here, $\text{arg}$ is the <a href="https://en.wikipedia.org/wiki/Argument_(complex_analysis)">complex-valued argument function</a>.)</li>
</ol>
<blockquote>
<p><strong>Note:</strong> In quantum field theory, the probability interpretation of the wavefunction is no longer the case; rather, $\Psi(x, t)$ is reinterpreted as a <strong>field</strong> and its real and imaginary parts are required to describe both particles and anti-particles. However, we will wait until later to introduce quantum field theory.</p>
</blockquote>
<h3 id="the-free-particle">The free particle</h3>
<p>We already know one basic solution to the Schrodinger equation (in the case $V = 0$): the case of plane waves $e^{i(kx - \omega t)}$. Because the Schrodinger equation is a linear PDE, it is possible to sum several different solutions together to form a new solution; indeed, the <em>integral</em> of a solution is also a solution! Thus, we have arrived at the solution to the Schrodinger equation for a free particle (in one dimension):</p>
<p class="mathcell">
$$
\Psi(x, t) = \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty dk~ g(k) e^{i(k x - \omega(k) t)}
$$
</p>
<p>This is known as a <strong>wave packet</strong>, since it is a superposition of multiple waves and in fact it  looks like a bundle of waves (as shown by the animation below)!</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/d/d8/Wave_packet_propagation_%28phase_faster_than_group%2C_nondispersive%29.gif" alt="Wavepacket animation, showing a &quot;pulse&quot; propagating along the positive x-axis" /></p>
<p><em>Source: <a href="https://en.m.wikipedia.org/wiki/File:Wave_packet_propagation_(phase_faster_than_group,_nondispersive).gif">Wikipedia</a></em></p>
<blockquote>
<p><strong>Reader's note:</strong> Another nice animation can be found at <a href="https://www.cond-mat.de/teaching/QM/JSim/wpack.html">this website</a>.</p>
</blockquote>
<p>Note that $g(k)$ is an arbitrary function that is determined by the initial conditions of the problem. In particular, using Fourier analysis we can show that it is given by:</p>
<p class="mathcell">
$$
g(k) = \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty dx ~\Psi(x, 0) e^{-ikx}
$$
</p>
<p>In the wave packet solution, $\omega(k)$ is called the <strong>dispersion relation</strong> and is a fundamental object of study in many areas of condensed-matter physics and diffraction theory. It relates the angular frequency (which governs the <em>time oscillation</em> of the free particle's wavefunction) to the wavenumber (which governs the <em>spatial oscillation</em> of the free particle's wavefunction). The reason we use the angular frequency rather than the "pure" frequency $\nu$ is because $\omega$ is technically the frequency at which the <em>phase</em> of the wavefunction evolves, and complex-exponentials in quantum field theory almost always take the phase as their argument. But what is $\omega(k)$? To answer this, we note that the speed of a wave is given by $v = \omega/k$. For massive particles (e.g. electrons, "massive" here means "with mass" <em>not</em> "very heavy") we can use the formula for the kinetic energy of a free particle, the de Broglie relation $p = \hbar k$ (in one dimension), and the Planck-Einstein relation $E = \hbar \omega$:</p>
<p class="mathcell">
$$
K = \dfrac{1}{2} mv^2 =  \dfrac{p^2}{2m} = \dfrac{\hbar^2 k^2}{2m} = \hbar \omega
$$
</p>
<p>Rearranging gives us:</p>
<p class="mathcell">
$$
\omega(k) = \dfrac{\hbar k^2}{2m}
$$
</p>
<p>And thus the wave packet solution becomes:</p>
<p class="mathcell">
$$
\Psi_\text{massive}(x, t) = \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty dk~ g(k) e^{i(k x -\frac{\hbar k^2}{2m} t)}
$$
</p>
<p>By contrast, for massless particles, the result is much simpler: we <em>always</em> have $\omega(k) = kc$ for massless particles in vacuum (the situation is more complicated for particles inside a material, but we won't consider that case for now). Thus the wave packet solution becomes:</p>
<p class="mathcell">
$$
\begin{align*}
\Psi_\text{massless}(x, t) &amp;= \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty dk~ g(k) e^{i(k x -kc t)} \\
&amp;= \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty dk~ g(k) e^{ik(x-ct)}
\end{align*}
$$
</p>
<blockquote>
<p><strong>Note:</strong> This is actually identical to the solution of the classical wave equation for an electromagnetic (light) wave, providing us with our first glimpse into how quantum mechanics is related to classical mechanics. The difference is that the quantum wavefunction is a probability wave, whereas the classical wave solution is a physically-measurable wave (that you can actually see!).</p>
</blockquote>
<p>Now, let's consider the case where $g(k) = \delta(k - k_0)$, where $k_0$ is a constant and is related to the particle's momentum by $p = \hbar k_0$. This physically corresponds to a particle that has an <strong>exactly-known momentum</strong>. We'll later see that such particles are actually physically impossible (because of something known as the Heisenberg uncertainty principle that we'll discuss later), but they serve as good mathematical idealizations for simplifying calculations. Placing the explicit form for $g(k)$ into the integral, we have:</p>
<p class="mathcell">
$$
\begin{align*}
\Psi(x, t) &amp;\approx \dfrac{1}{\sqrt{2\pi}} \int_{-\infty}^\infty dk~ \delta(k - k_0) e^{i(k x - \omega t)} \\
&amp;= \dfrac{1}{\sqrt{2\pi}} e^{i(k_0 x - \omega _0 t)}, \quad \omega_0 = \omega(k_0)
\end{align*}
$$
</p>
<blockquote>
<p><strong>Note:</strong> This comes from the principal identity of the Dirac delta function, which is that $\displaystyle \int_{-\infty}^\infty dx~\delta(x - x_0) f(x) = f(x_0)$.</p>
</blockquote>
<p>Where the approximate equality is due to the fact that, again, particles with exactly-known momenta are physically impossible. This is (up to an amplitude factor) the <strong>plane-wave solution</strong> that we started with, when deriving the Schrödinger equation! From this, we have a confirmation that our derivation is indeed physically-sound and describes (idealized) quantum particles.</p>
<p>Now, let us consider the case where $g(k)$ is given by a Gaussian function:</p>
<p class="mathcell">
$$
g(k) = \dfrac{1}{(2\pi)^{1&#x2F;4} \sigma} e^{-(k-k_0)^2&#x2F;4\sigma}, \quad \sigma = \text{const.}
$$
</p>
<p>This may <em>look</em> complicated, but the constant factors are there to simplify calculations. If we substitute this into the integral, this gives us:</p>
<p class="mathcell">
$$
\Psi(x, t) = \dfrac{1}{\sqrt{2 \pi \sigma}} e^{-x^2&#x2F;\sigma^2}e^{i(k_0 x - \omega_0 t)}
$$
</p>
<p>This is <em>also</em> a Gaussian function! Notice, however, that our solution now depends on a constant $\sigma$, which controls the "width" of the wave-packet. We will soon learn that it physically corresponds to the <em>uncertainty in position</em> of the quantum particle. Keep this in mind - it will be very important later.</p>
<h4 id="the-classical-limit-of-the-free-particle">The classical limit of the free particle</h4>
<p>Now, let us discuss the classical limit of the wavefunction. We know that $\Psi(x, t)$ describes some sort of probability wave (though we haven't exactly clarified what this probability is meant to represent). We can take a guess though - while quantum particles are waves (and all matter, as far as we know, behave like quantum particles at microscopic scales), classical particles are point-like. This means that they are almost 100% likely to be present at one and exactly one location in space, which is what we classically call the <em>trajectory</em> of the particle. Thus, a classical particle would have the wavefunction approximately given by:</p>
<p class="mathcell">
$$
\Psi(x, t) \sim \delta (x - vt)
$$
</p>
<p>This is a second example of the <strong>correspondence principle</strong>, which says that in the appropriate limits, <em>quantum mechanics approximately reproduces the predictions of classical mechanics</em>. This is important since we don't usually observe quantum mechanics in everyday life, so it has to reduce to classical mechanics (which we do observe) at macroscopic scales!</p>
<h3 id="quantum-operators">Quantum operators</h3>
<p>In classical mechanics, physical quantities like energy, momentum, and velocity are all given by <em>functions</em> (typically of space and of time). For instance, the total energy of a system (more formally known as the <em>Hamiltonian</em>, see the <a href="https://jackysci.com/advanced-classical-mech/part-2/">guide to Lagrangian and Hamiltonian mechanics</a> for more information), is given by a function $H(x, p, t)$, where $x(t)$ is the position of the particle and $p(t)$ is its momentum (roughly-speaking). However, in quantum mechanics, each physical quantity is associated with an <strong>operator</strong> instead of a function. For instance, there is the momentum operator $\hat p$, the position operator $\hat x$, and the Hamiltonian operator $\hat H$, where the hats (represented by the symbol $\hat{}$) tell us that these are <em>operators</em>, not functions.</p>
<p>So what is an operator? An operator is something that takes one vector (or function) and transforms it to another vector (or function). A good example of an operator is a transformation matrix.</p>
<h4 id="the-uncertainty-principle">The uncertainty principle</h4>
<p>Heisenberg uncertainty principle means that momentum and position cannot be measured at once. It comes straight from the definition of the momentum and position operators and the fact that their commutator is nonzero.</p>
<h4 id="eigenstates-of-the-momentum-operator">Eigenstates of the momentum operator</h4>
<p>There is another interesting characteristic of the free particle - its wavefunction is an eigenstate of the momentum operator. To see why, simply solve the eigenvalue equation for the momentum operator:</p>
<p class="mathcell">
$$
\hat p \psi = i\hbar \dfrac{\partial \psi}{\partial x} = p \psi
$$
</p>
<p>This has the straightforward solution $\psi(x) = e^{\pm ipx/\hbar}$.</p>
<p>Momentum eigenstates are physically cannot exist, because real particles, of course, have to be <em>somewhere</em>, and by the Heisenberg uncertainty relation a pure momentum eigenstate means a particle can be <em>anywhere</em>! However, they are a good approximation in many cases to particles with a very small range of momenta.</p>
<h4 id="eigenstates-of-the-position-operator">Eigenstates of the position operator</h4>
<h4 id="eigenstates-of-the-hamiltonian">Eigenstates of the Hamiltonian</h4>
<h3 id="the-born-rule">The Born rule</h3>
<blockquote>
<p><strong>Born rule (for continuous quantities):</strong> For any continuous observable represented by operator $\hat a$, with eigenstates $|\alpha\rangle$ and eigenvalues $\alpha$, the wavefunction $\psi(\alpha)$ represents the <em>probability amplitude</em> $c(\alpha)$ of measuring the corresponding observable's value to be $\alpha$.</p>
</blockquote>
<blockquote>
<p><strong>Born rule (for discrete quantities):</strong> For any discrete (quantized) observable represented by operator $\hat a$, with eigenstates $|\alpha\rangle$ and eigenvalues $\alpha$, the wavefunction $\psi_\alpha$ represents the <em>probability amplitude</em> $c_\alpha$ of measuring the corresponding observable's value to be $\alpha$.</p>
</blockquote>
<h3 id="bound-and-scattering-states">Bound and scattering states</h3>
<p>To understand the difference between bound and scattering states, we need to examine the concept of <strong>normalizability</strong>. Bound states are normalizable states, meaning that they satisfy the <strong>normalization condition</strong>:</p>
<p class="mathcell">
$$
\int_{-\infty}^\infty |\psi(x)|^2 dx = 1
$$
</p>
<p>This allows their squared modulus $\rho = |\psi(x)|^2$ to be interpreted as a <strong>probability density</strong> according to the Born rule. An essential part of a bound state is that it admits solutions to $\hat H \psi = E \psi$ where $E &lt; 0$. This is required for the formation of bound states: the bound-state energy must be <em>negative</em> so that the system is stable.</p>
<p>However, scattering states are not necessarily normalizable. In theory, particles undergoing scattering should be described by wave packets. In practice, this leads to unnecessary mathematical complexity. Instead, it is common to use the <strong>non-normalizable</strong> states, typically in the form of plane waves:</p>
<p class="mathcell">
$$
\psi(x) = A e^{\pm ipx&#x2F;\hbar}
$$
</p>
<p>Since these scattering states are not normalizable, $|\psi|^2$ <em>cannot</em> be interpreted as a probability distribution. Instead, they are purely used for <em>mathematical convenience</em> with the understanding that they <em>approximately</em> describe the behavior of particles that have low uncertainty in momentum and thus high uncertainty in position. Of course, real particles are described by wave packets, which are normalizable, but using plane waves gives a good mathematical approximation to a particle whose momentum is close to perfectly-known.</p>
<p>We can in fact show this as follows. Consider a free particle at time $t = 0$, described by the wave packet solution, which we've seen at the beginning of this guide:</p>
<p class="mathcell">
$$
\psi(x) = \Psi(x, 0) = \dfrac{1}{\sqrt{2\pi \hbar}} \int dp&#x27;~\overline \Psi(p&#x27;) e^{ip&#x27;x&#x2F;\hbar}
$$
</p>
<blockquote>
<p><strong>Note:</strong> We changed the integration variable for the wavepacket from $p$ to $p'$ to avoid confusion later on. The integral expressions, however, are equivalent.</p>
</blockquote>
<p>Now, assume that the particle's momentum is confined to a <strong>small</strong> range of values, or equivalently, has a <strong>low uncertainty in momentum</strong>. We can thus make the approximation that $\overline \Psi(p') \approx \delta(p - p')$, where $p$ is the particle's momentum. Thus, performing the integration, we have:</p>
<p class="mathcell">
$$
\psi(x) \approx \dfrac{1}{\sqrt{2\pi \hbar}} \int dp&#x27;~ \delta(p - p&#x27;) e^{ip&#x27;x&#x2F;\hbar} \sim \dfrac{1}{\sqrt{2\pi}} e^{ipx&#x2F;\hbar}
$$
</p>
<p>This is exactly a plane wave in the form $\psi(x) = Ae^{ipx/\hbar}$, and a momentum eigenstate! Thus we come to the conclusion that while momentum eigenstates $\psi \sim e^{\pm ipx/\hbar}$ are non-renormalizable and thus unphysical, they are a good approximation for describing particles with low uncertainty in momentum.</p>
<p>Likewise, wavefunctions of the type $\psi(x) \sim \delta(x-x_0)$ are also unphysical, and are just mathematical approximations to highly-localized wavepackets, where the particles' uncertainty in position is very small. Thus, we conclude that eigenstates of the position operator (which are delta functions) are also non-renormalizable, which makes sense, since there is no such thing as a particle with exactly-known position (or momentum!).</p>
<h2 id="the-abstract-state-vector-formalism">The abstract state-vector formalism</h2>
<h3 id="review-of-linear-algebra">Review of linear algebra</h3>
<h3 id="introduction-to-dirac-s-bra-ket-notation">Introduction to Dirac's bra-ket notation</h3>
<h3 id="the-state-vector-and-unitary-time-evolution">The state-vector and unitary time evolution</h3>
<p>In this formalism, the quantum state is represented as a vector, called a <strong>state-vector</strong>, and written using Dirac notation as $|\Psi(t)\rangle$. The quantum state "lives" in a <strong>Hilbert space</strong> $\mathcal{H}$, which is complex-valued and can be finite or infinite-dimensional.</p>
<p>Now consider the state-vector at a particular moment in time, for instance, $t = 0$. Then, let $|\Psi\rangle = |\Psi(0)\rangle$ be the time-independent state-vector. We can decompose $|\Psi\rangle$ as a superposition of basis vectors $|\alpha\rangle$ as either a sum:</p>
<p class="mathcell">
$$
|\Psi\rangle = \sum_i c_i |\alpha_i\rangle
$$
</p>
<p>Or as an integral:</p>
<p class="mathcell">
$$
|\Psi\rangle = \int c(\alpha)|\alpha\rangle~ d\alpha
$$
</p>
<p>Such basis vectors must be the <strong>eigenstates</strong> of quantum-mechanical operators that represent <strong>physical quantities</strong> like position, momentum, energy, and spin. Discrete operators (such as spin $\hat S$) have eigenstates that are (finite-dimensional) vectors; continuous operators (such as position $\hat x$ and momentum $\hat p$) have eigenstates that are continuous functions (alternatively, infinite-dimensional vectors). The <strong>eigenvalues</strong> of such operators are the possible measurable values of the operator (such as possible energies or momenta of a particle); meanwhile, the coefficients $c_i$ (in the discrete case) and $c(\alpha)$ in the continuous case are interpreted as <strong>probability amplitudes</strong>. One can then find the <strong>probability</strong> of measuring the $i$-th eigenvalue of a discrete operator with:</p>
<p class="mathcell">
$$
P = |c_i|^2, \quad c_i = \langle \alpha_i|\psi\rangle
$$
</p>
<p>In the continuous case, the probability amplitude $c(\alpha) = \langle \alpha|\psi\rangle$ becomes a continuous function (equivalently, an <em>infinite-dimensional vector</em>), which is called the <strong>wavefunction</strong>, and denoted $\psi(\alpha)$. one may obtain the <strong>probability density</strong> $\rho$ of measuring eigenvalue $\alpha$ with:</p>
<p class="mathcell">
$$
\rho = |\psi(\alpha)|^2 = \psi(\alpha)\psi^*(\alpha)
$$
</p>
<p>Collectively, these two formulas are known as the <strong>Born rule</strong>. In the case of the position operator $\hat x$, the eigenvalues of the position $\hat x$ are possible positions $x$, and eigenstates are position eigenstates $|x\rangle$. Thus, the wavefunction takes the form $\psi(x)$, and by the Born rule, taking its squared norm $|\psi|^2$ gives the <strong>probability per unit volume</strong> of measuring a particle at position $x$.</p>
<p>And it is not only the probabilities of positions that we are able to calculate. Recall that while we chose the position basis for the wavefunction, there is no reason why we are restricted to just the position basis. We can define a wavefunction in any orthonormal basis we would like in quantum mechanics, so wavefunctions that are a function of momentum $\psi(p)$ (or any other continuous basis) are also perfectly valid.</p>
<hr />
<p>For instance, the probability a particle is in its $|E_1 \rangle$ state corresponding to having an energy of $E_1$ is given by;</p>
<p class="mathcell">
$$
P = \Psi_1 \Psi_1^*
$$
</p>
<p>Recall that the Schrödinger equation is given by:</p>
<p class="mathcell">
$$
i \hbar \frac{\partial}{\partial t} | \Psi \rangle = \hat H | \psi \rangle
$$
</p>
<p>And remember Newton's 2nd law as the key equation governing how a classical state can evolve? Quantum states evolve too, but under a partial differential equation called the <strong>Schrödinger equation</strong>:</p>
<p class="mathcell">
$$
i \hbar \frac{\partial}{\partial t} | \Psi \rangle = \hat H | \psi \rangle
$$
</p>
<p>Where $\hat H$ can be thought of as a type of matrix that acts on the state-vector $| \Psi \rangle$. What is its physical interpretation? That is what we'll see in the next section.</p>
<p class="mathcell">
$$
E | \Psi \rangle = \hat H | \psi \rangle
$$
</p>
<p>Where $E$ is a constant associated with, understandably, the energy. This form is easier to solve, and can be used to find explicit analytical solutions for a variety of quantum systems.</p>
<p>Thus the Schrödinger wave equation simplifies to something far more familiar, a partial differential equation:</p>
<p class="mathcell">
$$
i\hbar \frac{\partial}{\partial t} \psi(x, t) = \left(-\frac{\hbar^2}{2m} \frac{\partial^2}{\partial x^2} + V(x, t)\right) \psi(x, t)
$$
</p><p class="mathcell">
$$
\psi(x) = \langle x | \Psi \rangle \Rightarrow \psi(p) = \langle p | \Psi \rangle
$$
</p><h2 id="intrinsic-spin">Intrinsic spin</h2>
<h3 id="what-exactly-is-intrinsic-spin">What exactly is intrinsic spin?</h3>
<p>"Intrinsic spin" (or just <em>spin</em>) is a shortened version of "intrinsic spin angular momentum", which is what we're <em>really</em> talking about when we say "spin" - a form of angular momentum that is a fundamental property of subatomic particles, like protons and electrons.</p>
<h3 id="the-stern-gerlach-experiment">The Stern-Gerlach experiment</h3>
<h3 id="application-to-electronics">Application to electronics</h3>
<p>Cover content in <a href="https://en.wikipedia.org/wiki/Spintronics">https://en.wikipedia.org/wiki/Spintronics</a>.</p>
<h2 id="advanced-quantum-theory">Advanced quantum theory</h2>
<h3 id="relativistic-wave-equations-and-the-dirac-equation">Relativistic wave equations and the Dirac equation</h3>
<p>Thus, we arrive at the Dirac equation for a <strong>free particle</strong>:</p>
<p class="mathcell">
$$
(i\hbar \gamma^\mu \partial_\mu - mc)\psi = 0
$$
</p>
<p>The Dirac equation with the electromagnetic four-potential $A_\mu = (A_0, \mathbf{A}) = (\frac{1}{c} V, \mathbf{A})$ takes a very similar form, except the partial derivative $\partial_\mu$ is replaced by a new differential operator $D_\mu$:</p>
<p class="mathcell">
$$
(i\hbar \gamma^\mu D_\mu - mc)\psi = 0, \quad D_\mu = \partial_\mu + \dfrac{ie}{\hbar} A_\mu
$$
</p><h3 id="second-quantization-and-quantum-electrodynamics">Second quantization and quantum electrodynamics</h3>
<p>In this section, we will not analyze the <em>full</em> relativistic theory of quantum electrodynamics. For that, see my <a href="https://www.learntheoreticalphysics.com/quantum-field-theory/">quantum field theory book</a>. Rather, we will discuss the non-relativistic theory of quantum electrodynamics (often referred to as NRQED for short), which nonetheless has many applications, including quantum optics and quantum information theory.</p>
<p>The process of going from <em>classical</em> electrodynamics to <em>quantum</em> electrodynamics is called <strong>second quantization</strong>, a term to differentiate it from <strong>first quantization</strong>, where we take classical variables (e.g. position, momentum, and angular momentum) and translate them into quantum operators.</p>
<p>To start, we note that an arbitrary electromagnetic field with electric potential $\phi$ and magnetic potential $\mathbf{A}$ can be decomposed as a sum (or integral) of plane waves (called <em>modes</em>), each of different wavevector $\mathbf{k}$ (this is just the Fourier series):</p>
<p class="mathcell">
$$
\begin{align*}
\phi(\mathbf{r}, t) &amp;= \sum_\mathbf{k}A_\mathbf{k} e^{i(\mathbf{k} \cdot \mathbf{r} + \omega t)} \\
\mathbf{A}(\mathbf{r}, t) &amp;= \sum_\mathbf{k} \vec B_\mathbf{k} e^{i(\mathbf{k} \cdot \mathbf{r} + \omega t)} \\
\end{align*}
$$
</p>
<p>Where $A_\mathbf{k}, \vec B_\mathbf{k}$ are constant coefficients in the series expansion over all modes. To quantize the electromagnetic field, it is necessary to sum over all the modes of the system....</p>
<p class="mathcell">
$$
\hat H  =  \sum_\mathbf{k}\hbar \omega_\mathbf{k} \left(\hat a_\mathbf{k}^\dagger \hat a_\mathbf{k} + \dfrac{1}{2}\right)
$$
</p>
<p>Note that since we have decomposed the electromagnetic field into modes, and each mode represents an <em>exact momentum</em> (by $\mathbf{p} = \hbar \mathbf{k}$), this means that by the Heisenberg uncertainty principle, photons are completely delocalized in space. Thus, the Fock states are states in the <strong>momentum basis</strong>, where particle states are plane waves of the form $e^{i\mathbf{p} \cdot \mathbf{x}}$.</p>
<p>One might ask, how do states in conventional quantum mechanics fit in to the quantum electrodynamics picture? For instance, if we had a hydrogen atom interacting with a quantized electromagnetic field, how could we model this? The answer is that as long as we're working with energies that are not high enough to require us to consider the effects of relativity (which we can assume to be true most of the time), we can just use the normal $|n, m, \ell\rangle$ states of the hydrogen atom. We know that ultimately, the hydrogen atom is made of elementary particles that come from quantum fields, but for our purposes, we can use the <em>first-quantized</em> hydrogen atom together with the <em>second-quantized</em> electromagnetic field.</p>
<h3 id="relativity-the-dirac-equation-and-the-road-to-qft">Relativity, the Dirac equation, and the road to QFT</h3>
<p>Unfortunately, the Dirac equation, despite its successes, has limited applicability. Why? Primarily, because at the relativistic energies it describes, new particles can be created from pure energy (remember Einstein's famous equation $E = mc^2$, this means that a particle of mass $m$ can be created from energy $E$ if $E/c^2 &gt; m$). Additionally, particles can annihilate with each other and be destroyed, and particles can turn into new (and often different types of) particles. The number of particles is never constant - new particles are being created all the time, and old particles are getting annihilated or turn into new particles. This makes the utility of a quantum wave equation that describes fixed numbers of particles rather limited; after a few nanoseconds (or shorter still), the electron you were describing no longer exists, and its wavefunction also vanishes.</p>
<h3 id="the-emergence-of-field-quanta">The emergence of field quanta</h3>
<p>Quantum field theory tells us that all matter in the Universe is composed of quantum fields. These fields are said to be <em>quantized</em> as they can only oscillate between distinct states. Mathematically, this corresponds to quantum fields being <em>operator-valued</em> as opposed to classical fields, which are functions of space and time.</p>
<p>Free particles, which have a very small range of momenta, can be approximated as plane waves $\psi(x) = e^{\pm ipx}$.</p>
<p>The energy of the lowest excited state of a quantum field is given (relative to the ground state) by:</p>
<p class="mathcell">
$$
E_\omega = \hbar \omega
$$
</p>
<p>In the case of massive fields (that is, fields describing particles with mass), this result can be written as:</p>
<p class="mathcell">
$$
E_\omega = E_k = \sqrt{(pc)^2 + (mc^2)^2} = \sqrt{(\hbar kc)^2 + (mc^2)^2}
$$
</p>
<p>This is a special case of the quantized energies of a massive field (that is, fields describing particles with mass), which comes from the relativistic energy-momentum relation:</p>
<p class="mathcell">
$$
E^2 = (pc)^2 + (mc^2)^2, \quad p = \hbar k
$$
</p>
<p>If we switch back to natural units, our expression reads:</p>
<p class="mathcell">
$$
E_k = \sqrt{k^2 + m^2}
$$
</p>
<blockquote>
<p><strong>Note:</strong> For massless particles (like photons), this simplifies to $E_k = k = \omega$</p>
</blockquote>
<p>We can show this result</p>
<p class="mathcell">
$$
p^2 + m^2 = E^2
$$
</p>
<p>The total energy is of course simply the sum of all of the modes (so sum over $\omega$ for the first and sum over $k$ for the second).</p>
<p>Note how both $\omega$ and $k$ describe oscillations - in fact, in natural units, we know that for massless particles, $\omega = k$. This tells us that <strong>stable particles are just long-lived vibrational modes in quantum fields</strong>. It is similar to how phonons in solid-state physics appear as quasiparticles from vibrational modes.</p>
<p>The total energy of a quantum field is given by summing over all the energy fluctuations of the field, which becomes an integral:</p>
<p class="mathcell">
$$
E_\text{total} = \int d^3 \omega~ E_\omega = \sum_k E_k
$$
</p><h3 id="second-quantization">Second quantization</h3>
<p>Action principle, etc. and then also link to the <a href="https://jackysci.com/advanced-classical-mech/">advanced classical mechanics guide</a> for an overview of tensors and the Euler-Lagrange equations.</p>
<p>To go from classical field theory to quantum field theory:</p>
<ul>
<li>Classical equations of motion become <em>operator</em> equations motion (that look the same but have very different properties)</li>
<li>Classical plane-wave solutions to the field equations become single-particle states of the fields</li>
<li>Fields have a nonzero energy even when in their lowest-energy state</li>
<li>Classical oscillating fields become coupled quantum harmonic oscillators</li>
</ul>
<h3 id="the-spin-statistics-theorem">The spin-statistics theorem</h3>

        
        <a id="jump-toc-btn" href="#toc">Show table of contents</a>
        <a href="/notes" class="return-link">Back to all notes</a>
        
    </article>

    <!-- We load KaTeX last for performance reasons -->
    <script defer src="https://jackysci.com/katex/katex.min.js"></script>
    <script defer src="https://jackysci.com/katex/contrib/auto-render.min.js"></script>
    <script defer src="https://jackysci.com/katex/contrib/mhchem.min.js"></script>
    <script defer src="https://jackysci.com/katex/contrib/copy-tex.min.js"></script>
    <script defer>
    function renderMath(element) {
        // renders math using KaTeX in a particular element
        renderMathInElement(element, {
          // customised options
          // • auto-render specific keys, e.g.:
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
          ],
          // • rendering keys, e.g.:
          throwOnError : false
        });
    }
    </script>
    
    <script defer>
        var toc = document.getElementById("toc");
        var tocPos = toc.offsetTop + toc.offsetHeight;
        var tocBtn = document.getElementById("jump-toc-btn");

        // return the top and bottom coordinates of the
        // user's position on the page
        function getViewport() {
            var scrollPosTop = document.documentElement.scrollTop;
            var scrollPosBottom = scrollPosTop + window.innerHeight;
            return scrollPosTop, scrollPosBottom
        }

        // for performance reasons, we **only** render a certain
        // number of equations that the viewer is actually viewing
        function VisibleMathRenderer(config) {
            /*
            Renders only a limited number of equations on page load
            to avoid poor performance
             Params:
                lastRenderedEquation: the most recently rendered equation.
                        when this goes out of view, equations under it are rendered. 
            */
            var startElement = config.startElement
            var maxEquations = config.maxEquations ? config?.maxEquations : 30;
            this.startElement = startElement
            this.maxEquations = maxEquations
            // we wait until the user scrolls past the starting/
            // ending elements to start rendering the whole page
            this.canRenderWholePage = false;
            this.pageRendered = false;
            this.lastRenderedTopEquation = null;
            this.lastRenderedBottomEquation = null;

            this.render = function() {
                renderMath(this.startElement);
                // render previous 25 and following 25 equations
                var prev = this.startElement.previousElementSibling;
                for (i = 0; i < this.maxEquations / 2; i++) {
                    // if there are no elements left prior to the element
                    if (prev == null) {
                        break;
                    }
                    renderMath(prev);
                    prev = prev.previousElementSibling;
                }
                // store our last rendered equations
                // we'll track scroll position later to
                // check when the rest of the page should be rendered
                this.lastRenderedTopEquation = prev;
                console.log(this.lastRenderedTopEquation)

                var next = this.startElement.nextElementSibling;
                for (i = 0; i < this.maxEquations / 2; i++) {
                    // if there are no elements left following the element
                    if (next.nextElementSibling == null) {
                        break;
                    }
                    renderMath(next);
                    next = next.nextElementSibling;
                }
                this.lastRenderedBottomEquation = next;
                // now allow rendering the rest of the equations
                this.canRenderWholePage = true;
            }

            // render all math on the whole page
            this.renderMathOnPage = function() {
                // don't run until preliminary tasks
                // are done so that the whole page
                // can/should be rendered
                if (!this.canRenderWholePage) {
                    return;
                }
                // if the whole page's worth of equations
                // are already rendered, don't render more
                if (this.pageRendered) {
                    return;
                }
                var topBound = this.lastRenderedTopEquation.getBoundingClientRect.top;
                var bottomBound = this.lastRenderedBottomEquation.getBoundingClientRect.bottom;
                var scrollTop, scrollBottom = getViewport();
                // if the user is about to scroll past the initially-rendered equations
                // we will render the whole page
                if (scrollTop - 50 + window.scrollY < topBound || scrollBottom + 50 + window.scrollY > bottomBound) {
                    console.log("Scrolled beyond!")
                    var article = document.querySelector(".post");
                    if (article) {
                        this.renderMath(article);
                    }
                    this.pageRendered = true;
                }
                
            }
            
        }

        function showTocBtnOnScroll() {
            // don't show toc button on print media
            if (window.matchMedia('print').matches){ return; }
            var _, scrollBottom = getViewport();
            // get bottom of viewport scroll position
            if (scrollBottom > tocPos) {
                tocBtn.style.display = "block";
            } else {
                tocBtn.style.display = "none";
            }
        }

        function findFirstRelevantElement() {
            // finds the first <p> tage that's closest to
            // the viewer's viewport
            var regex = /#.*/;
            var m = regex.exec(window.location.href);
            if (m !== null) {
                return document.querySelector(m[0]);
            } else {
                return document.querySelector(".post p");
            }
        }
        
        // initialize page JS components
        /*
        var mathRenderer = new VisibleMathRenderer({
            // start rendering with first <p> tag on the
            // post
            startElement: findFirstRelevantElement()
        });
        */
        document.addEventListener("DOMContentLoaded", function() {
            showTocBtnOnScroll();
            var article = document.querySelector(".post");
            if (article) {
                renderMath(article);
            }
        })

        window.onscroll = function(){
            // if (!mathRenderer.pageRendered) {
            //     mathRenderer.renderMathOnPage();
            // }
            showTocBtnOnScroll();
        };


    </script>
    


</body>

</html>
